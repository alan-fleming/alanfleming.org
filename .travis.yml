language: ruby
rvm:
- 2.6
script:
- bundle exec jekyll build
- bundle exec htmlproofer ./_site --disable-external --empty-alt-ignore
branches:
  only:
  - master
before_deploy:
- openssl aes-256-cbc -K $encrypted_db2095f63ba3_key -iv $encrypted_db2095f63ba3_iv -in deploy_rsa.enc -out deploy_rsa -d
- chmod 600 /tmp/deploy_rsa
- eval "$(ssh-agent -s)"
- ssh-add /tmp/deploy_rsa
- echo -e "Host $DEPLOY_HOST\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config
env:
  global:
  - NOKOGIRI_USE_SYSTEM_LIBRARIES=true
  - secure: ZC8Q+6fleEIeqsWXyDW9cs4wAm9BVdLx7WQ9Bu58rR/hxMsL/jFpxzM6uGa3dcHIIoiHETFA5mvrway0Lom96CWOoCIojOiWR7Am0/CfZyq/QvoKwTiDido7cPqj8d/R10fi0Md5xxB9KuWzFH1Nbk/0jhoO+gipd8nVa0kZL4+i7q/37DWeod0LFlnj6+kYOI99qJc3EO92qZJjAwFOYw5yJ/sqOT1C7FljnhhRcMRE3mXObnD/w0yj2By/K9VyAvW9/Bnz/Kl5nQX1YQtetpJzfgDRKeE+e8q6wTeG/paBLA3DxoRoWeeg4em+vTLObfNpxp7td82D9cmplLGVKpchoELv80SPN7J178HP1l1rZmhK/Tl+52Z6q+2m7+HvQK0f6VnaLSNFYDYiChf4nFd04F1t7Iu466Z3vcTuB2phf3wJRQGd+u9K5y9QOYXm1ClK+tFlSH4zCv9B5YeXnWRQGqA1+xo7oI3jhnJEAiNsOECSBvc5Xff4Mc3AXSdcdjIDOS2N1+NvH7xxIguTrEIIPAUOH8WgoYC+5a3UxGEuzSnUJB9E1Lzr56wVGbvQ43Bcr82eUr90fBwEsdwNoDMJNjw/M7BmX+tAjSM8+MesoWK1/M2m1CDECjftRRCnS61CXh+cZtDsoFnz8dUcTZQLxIG943tovzNDuh9YvKc=
  - secure: m0loIS7CQY5qSorqUtR0PoMvZ2wv7ENQpzEoI9N28P0c9oNKJZhwpjXwq1TaaxFzhrruFq1emNjjjbSSk7x8GFxx8D/oYhTFLDTBY9met31ccIDqgHrZQrLjmhXH4WnnthfkbFBUFrDVwbSyqgR7fRHMjVMZIFtAyrLGiNfXTHKdhg+jMdKEFgGOdtJxUVLJwXvjONST74Wci9LqGpPS1OBf1dEor0OTsEyHrHB5zPrLqEeTtgXd8//ipNynS/lwcqxpp++GAOjXniUI0wt9W4Ih5VuR7isll7bpL2FDMviokh4oymiJi17jIvDlqPPPGNIVXkcCvobB0uN/KpuDGM4pmVuDofJ03g1eHPYPcanTgAg4HGFJCXFEV5JYjop+Lz2jimtd5tQVxQswlEk2IqQdo8AW8nXEFr0yILm4+SEZucSNhJZVq/KAUS9fUunHvHbx7mGa7wzh88JCN+yH3RV3cYFhcExEgzyYQZuHW/7sZ/AIl8xgBmdumszbOrWE26/sgg+1YdIuafSsdb0vMUCLFnOoMZHlRewiqEzGTnTDEP4uk9gTCQMwdyXSxKun4G22rLY9OSzp5P8z3javwBRuKuR4VoqIyRdmZP0spKQJ381zg7tiyu2aoc5qo+8Q/CXl8W6fCmLKHnlfLQH095RdvnANJVVlj0xXPEJN7dU=
  - secure: x1tZaoZjRTN6Ga/NpgEEATJqabRojyL3qZGAnub6KMEfNDoFLBUlLYgC9H+WKLCU+jfDkFi1G22AUtZZIGtW+nkEWycc8Q5u4Y9ZCufVFh9ixilhgYn2ii5ZOYHCxid3G0+9TrpCF3xJSjxqivgx9BMPw+LkAVHRFeoa2ZcUYIQJ6LWPlGBSwQUFi/XJgCsDRglUrGfcgT/7ozKOUSLZCuZDOVM7VH/E19d278GH36azFG10r4vg6jpJQE9PdyYAn2gaqa4IKXZhtsxfETAYV60XT35daKlcxElllRdYTDKU8lCKK1Vv0yfInQiqmiqmyDsRCRlCjj8R7z4yDett22NlvSXt1jYWBFQHDx4L0gIS+k6pIKvDvCv4T+Z/EnWgNsJl2+FMakb7hzsJvU0hCfwDFUy+ghEBFKl7JQmWzLR+TScj5YcHWi6cWkU/kBWYVqTcQR8+uX0i0M909u+YzQo+aXYaTWZ7m6UKBXWfdbP5NgGDvrGJd0i6SMWYCeHbkipVPt4sMCa4hrugoct99xCrNRShOnUZ2LuhC/Ulrn0qmzJnoBue0ZIdnRlw4ZQzg/jxNn8vxdBTXTqbmS+5M29MWNFKiIsVlvdYv1go0njd6bmH11bkEW5Tvwj8i2qLJ1HC+52QPpEBpLGROXeE8Ncv8dmlm5RuONNK+SRsyu4=
  - secure: ne1oHZXfbsN0pmePDTL0/ERyYeCxFta0g2ahLR0wdxN6I4yytTuE7cHsxsRpWD/mqvp/niI9zReTkqYntazAmhEP+yD9BsihcRWcZ1jNAsAah5F9QdPYj/x2qT+dewuESMxSjx57SF9JPR8BPKasxxzS3Bq3pn7eX6K3qIOkyVwXNlkE5tCywIXEdmbc3HSMlNoak3o/pmW981DIfLbacMNc03+i8gt2geDt/IBBngrrm/x4bA6LHDBWUY/rkvytSilVjct6uOdOsk+H28Ube+eeoyUuOuoYtqg4d/GHuviuMEGMF3c9jr47kYVG6ZdLGZHtpKnlQE67Bb/K5aLCcTao2xxE0adEULOAYJeF51fT2440JN2fx2FYzwEQBTLtk+tt04hRsX5sYaN1/RGWHe/XNrkrW1ibQN3p2/Ob5mV239CUdseGOpht+ES2J5Vxmbn3tttVR5lEb2kSIABZ1w7LXfKgeWLSTc5NMKrtJ4UdH1rFT5bO9IpjkAFmhY61x0nOk4OsbmxFBzyTztmwalI53P0oqzhWTxZXndd35Sc/4xg7DfTZCvswHb6RhogIqnkqGCcPH13PY4IqK8euzjs4/xBoBr5xTjeumvLamEXpIfgHPHhmZKpt6w72vmg1SkrXmuBiFbKC2aInkGhUfZwcjp/EoILFXHoAcZ+wHt4=
deploy:
  provider: script
  skip_cleanup: true
  script: rsync -r --quiet -e 'ssh -p $DEPLOY_PORT' _site/ $DEPLOY_USER@$DEPLOY_HOST:$DEPLOY_DIRECTORY --delete-after
  on:
    branch: master
