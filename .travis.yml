language: ruby
cache: bundler
rvm:
- 2.6
script:
- bundle exec jekyll build
- bundle exec htmlproofer ./_site --disable-external --empty-alt-ignore
branches:
  only:
  - master
before_deploy:
- openssl aes-256-cbc -K $encrypted_db2095f63ba3_key -iv $encrypted_db2095f63ba3_iv
  -in deploy_rsa.enc -out /tmp/deploy_rsa -d
- chmod 600 /tmp/deploy_rsa
- eval "$(ssh-agent -s)"
- ssh-add /tmp/deploy_rsa
- echo -e "Host $DEPLOY_HOST\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config
env:
  global:
  - NOKOGIRI_USE_SYSTEM_LIBRARIES=true
  - secure: p85GKQYa76Z9Zrgt47SNaICzxKEOG5mt6SQcxq0zacogzjXvJi+e6hKv66N+jYEcjE6YINw0pSWbIswvvpDXJuk7qXN6BvdL1LiqerFgd1E5DYU2u9zPFsBDgUqw9o+tFWj4jK3QiTvhD8e7pONgZHiNrHey4APnxqEuvdAR1P2TjzBS0GGehN4eMuzDd9ZCxwKJsP5g2YYISZsfEJnTE/kzVuTumyDYyOrpfL1xfnEWDw+lD7tD6xPaRZRge+I+B1lK5OyyTJ7KY5Bb33dPNF0T0APGp9swwvZcdHpWKABTrmRYAlKmK0SK8Bhe0kuf0dPtA+K8Zxhj+sEIdgn8FZOOmIOUbbZ/QepSs37iAy3jtNwx3xpSGfyaCWYR2Zh7eVGQbedWlNm3gp50MGon+NW6y5+DXaUmGEUFZogwlAnf1sZMSqrTVR5rytsTUUbM4+tREPxNSgcstRamXau0rk5AMkVZB28yxzj6WWg32ryr7vMbuTkl9vpLJIJaoMSUGuc7gzag9YW4iPn1hbVp8TgiXktqcSKTkxHbbOUgL0s+t5U5Ui647/xd35unXR6mxhmu+W4slIHHFbM/igmgnrKCXQ1HSKk8XmE+1v1SSj2Eb6YgyKweQBey0kSdm+NHrMj54UvSMUBL8eP2HE+GI5Yzym2KfI7XV33hibKCXOc=
  - secure: XqkBBdcD1BQ2HN7ptpJCv1sxgkZ2o7dz3ufq+iuN8GyNl3ZEVonfpm1F3gLNW1n1uneamWMKrE8EAVkbAigKRl/Ebtj804RXSq+jWEP5V07yAlySzTGNct05X3GnVo01OKVzQV8G9w+ux5f1sEHSeOWhVKMVv20T6b7f6qOPFDB9VVCFKzCbvMhanqd5V/wN1Fqa3wSKnBIyi0imPmpYl6JWcjxLT0d4WtNW8B5dY1pZAzlGrydRCCVSepKAZbbsfeUfC7qKUgP1q/t7V3f7e8D5R0wdES7nZzYgyK5uU9F7dHkwNEdFnjQ/4mCbIculQn0/c5wANZKcQGL1auInbKUGn9xK2iHL1GmYDm5TyoBM4Sk35H+/GVjbb5UPu7GoIU1GrYnxmBd1FyxVjEC6rLlnHI1aoilBu9H2sKjwndSUys3/ABIMxbQxfSNyojIJNwUYA7QZsf9cBG6Q5k7N4terSSjfIFD+IealIsEl/VzY5GzbVhETcdwELpJ6H4sdXBxWdjbfSVjEgZz7xB0jgzKAjWaSCjDq7sudnQJciypyP69R54PK3tjGqrW6tXpwC5ZL7w+ha4PEBlpJc3zPE1YxaU9xFriGlW6dT0HodefS5WdkCTzWTyoqdsKKzUhdTM+AqVgK/Nk+kyLjNBJDCqiTzAtVaR8Dvc8SjxsRT6Y=
  - secure: rDwZLOpLIx55zrsjub/QBgfHZp39vsiyE+eXdPrZR8F2+lanAwDe+l1AGYviX0MuPkJmHoRCFxYq8u5nTfP5A6+DpaVWr2YIflRi50hBH3RZevJgx93vQdWv0DS3wrih2CMJSQXlE1GQvSw/owC1+MR9NVrKOaA3OXAIc7ZBZgIqGy7hUhBteKDsFcZF1Uh+TgpWj/Gy+Pr7CsPKog5V7uCsRXorUFH9+s4htHE/BYoMWh35IQ7Um87J2Xum+IsHQExu5JitoJ82yL/3biE7AMljEzUr1hY1ZnMCbOxPKLTM+EunbyU0eQ4LzkjdpMFQ95kkhBFFIbcJJemEuiRzfaS4mrXUOscNrOCiom21C9XOGRr2NoRNEmb8qEAvey1MVxhb9KEpleOnZy/3lVtCgyQApZD7eK12KXnKPxvPH/f/7CE6GGe2xuCKeimsC5czc3YWcKPc9UbWMmi1kFWDPMUloW/odrVuWjOrKiiVZTtPRAUfrF3cNQzTJyBpsaAEpfXo4hPBY5+g7rnKkCfGfOoqFl+OIF2D0fDHWOtZHHzfm5oa85QTiAwmjC4i2EdDknY+mfYeBjVQP0i6ncJ1UvahUqNXTvwUcPlVfCFs3+5fSoXeDk8ltkTQw1cNClbEXVac02VUIm0XRsEBQIT9jeMckwLahipEvWoEO5YFpas=
  - secure: ozfVJGT0UP6RX9PBgZbrAWOIfFfOiWouBfHSwfSwSJ94IrgTcd/q/5Xi85/g0HmQw+Qv5E2UPcKCjTrsOHrGB32xOsWpdoKuevvNaci7Cr7DvNH6z7lHZUehXUPzM4W1UXgwu1iEsfR+KHC0/jdZUWUmohzIcRX8/MgcR8DO9ih88fTIZRCr9JSumbMX6HosJvZSEpzeAa0tEofOe8vaa0bcLMImMI+fCRwWXdg5Y2niLd2QJazD7wV6SK8i6iqjYsJNGeW94v4pu2YifQLgMNMkPHdXhyL1GatlBopondeES0yLh0SrtLuS0j4fo927gvsR0tzYrM0Z/ISbf+eUki103Ry3RVBlmZvtCyiO7Kq0+8k+uQy0JP/ymiCRVR2FeL4sBldx2O4RPduaEvFzwak6K7DcNLcdZY85S/LPx5zcivhG6xAIcmVZITaRdbsc8mrQGjdYpB4WFhm8uWxbfMbtilY06ngn7vfOqhNdlKKhNIG8WLZzyHb70gJhluKvfqRw+0Vl7+AIWwT4sckUT3TgYqwtK1xTyKsydrA+Fy2f0RsXlAytKOZilQ4NHAy+lg8yYO1oZUlsrYl7H+vieblKm9jRJ16KKS+wMRcvpgff0K4Mq8sgj9eQWF4d8/lRTreU5N1lmpr2GzJpFrmeg1z2qtuRgHva+ZhIsFnR/7g=
deploy:
  provider: script
  skip_cleanup: true
  script: rsync -r --quiet -e 'ssh -p $DEPLOY_PORT' _site/ $DEPLOY_USER@$DEPLOY_HOST:$DEPLOY_DIRECTORY
    --delete-after
  on:
    branch: master
